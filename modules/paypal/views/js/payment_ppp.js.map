{"version":3,"file":"js/payment_ppp.js","mappings":";MAyBA,IAAIA,EAAM,CAAC,EACPC,GAAmB,EACvBC,EAAEC,UAAUC,OAAO,WA6BbF,EAAE,0BAA0BG,SAAS,oBATzC,SAASC,IAnBT,IACMC,EAmBiB,oBAAVC,QAnBPD,GAAU,EACC,WAAXE,UACFF,GAAU,GAIZP,EAAMQ,OAAOE,KAAKC,IAAI,CACpB,YAAeC,eACf,YAAe,SACf,KAAQH,QACR,SAAYI,mBACZ,QAAWC,kBACX,eAAkB,UAClB,WAAc,WACd,iBAAoBP,KAMpBQ,WAAWT,EAAkB,IAKjC,CAGEA,GAIFJ,EAAE,gCAAgCc,GAAG,SAAS,SAACC,GAC7C,IAAIC,EAAiBhB,EAAE,sCAAsCiB,KAAK,MAC9DjB,EAAE,IAADkB,OAAKF,EAAc,4CAA2Cb,SAAS,iBAC1EY,EAAEI,iBACFJ,EAAEK,kBACFC,IAEJ,GACF,IAIA,IAAMA,EAAa,WACjB,GAAItB,EAAkB,CACpBA,GAAmB,EAEnB,IACEC,EAAEsB,SAASC,KAAK,CACdC,QAAS,kCAAFN,OAAoCO,sBAAqB,cAChEC,YAAY,EACZC,OAAQ,OACRC,QAAS,CACPC,QAAS,CACPH,YAAY,KAIpB,CAAE,MAAOX,GACPd,SAAS6B,cAAc,gCAAgCC,UAAW,CACpE,CAEA/B,EAAEgC,KAAK,CACLC,KAAM,OACNC,IAAKC,aACLC,SAAU,OACVC,KAAM,CACJC,UAAWC,cAEbC,QAAS,SAACC,GACJA,EAAKD,QACP1C,EAAI4C,aAEJC,OAAOC,SAASC,QAAQJ,EAAKK,cAEjC,GAEJ,CACF","sources":["webpack://paypal/./_dev/js/payment_ppp.js"],"sourcesContent":["/**\n * 2007-2023 PayPal\n *\n * NOTICE OF LICENSE\n *\n * This source file is subject to the Academic Free License (AFL 3.0)\n * that is bundled with this package in the file LICENSE.txt.\n * It is also available through the world-wide-web at this URL:\n * http://opensource.org/licenses/afl-3.0.php\n * If you did not receive a copy of the license and are unable to\n * obtain it through the world-wide-web, please send an email\n * to license@prestashop.com so we can send you a copy immediately.\n *\n * DISCLAIMER\n *\n * Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n *  versions in the future. If you wish to customize PrestaShop for your\n *  needs please refer to http://www.prestashop.com for more information.\n *\n *  @author 2007-2023 PayPal\n *  @author 202 ecommerce <tech@202-ecommerce.com>\n *  @license http://opensource.org/licenses/osl-3.0.php Open Software License (OSL 3.0)\n *  @copyright PayPal\n *\n */\nlet ppp = {},\n    exec_ppp_payment = true;\n$(document).ready( () => {\n  function initPaymentWall() {\n    let showPui = false;\n    if (modePPP == 'sandbox') {\n      showPui = true;\n    }\n\n    // Add parameters for paypal plus method\n    ppp = PAYPAL.apps.PPP({\n      \"approvalUrl\": approvalUrlPPP,\n      \"placeholder\": \"ppplus\",\n      \"mode\": modePPP,\n      \"language\": languageIsoCodePPP,\n      \"country\": countryIsoCodePPP,\n      \"buttonLocation\": \"outside\",\n      \"useraction\": \"continue\",\n      \"showPuiOnSandbox\": showPui\n    });\n  }\n\n  function waitPaypalLoaded() {\n    if (typeof PAYPAL == \"undefined\") {\n      setTimeout(waitPaypalLoaded, 200);\n      return;\n    }\n\n    initPaymentWall();\n  }\n\n  if ($('#checkout-payment-step').hasClass('js-current-step')) {\n    waitPaypalLoaded();\n  }\n\n  // Order payment button action for paypal plus\n  $('#payment-confirmation button').on('click', (e) => {\n    let selectedOption = $('input[name=payment-option]:checked').attr('id');\n    if ($(`#${selectedOption}-additional-information .payment_module`).hasClass('paypal-plus')) {\n      e.preventDefault();\n      e.stopPropagation();\n      doPatchPPP();\n    }\n  });\n});\n\n\n// Show popup and call doCheckout() function from API\nconst doPatchPPP = () => {\n  if (exec_ppp_payment) {\n    exec_ppp_payment = false;\n\n    try {\n      $.fancybox.open({\n        content: `<div id=\"popup-ppp-waiting\"><p>${waitingRedirectionMsg}</p></div>`,\n        closeClick: false,\n        height: 'auto',\n        helpers: {\n          overlay: {\n            closeClick: false\n          }\n        },\n      });\n    } catch (e) {\n      document.querySelector('#payment-confirmation button').disabled = true;\n    }\n\n    $.ajax({\n      type: 'POST',\n      url: ajaxPatchUrl,\n      dataType: 'json',\n      data: {\n        idPayment: idPaymentPPP,\n      },\n      success: (json) => {\n        if (json.success) {\n          ppp.doCheckout();\n        } else {\n          window.location.replace(json.redirect_link);\n        }\n      }\n    });\n  }\n}\n\n"],"names":["ppp","exec_ppp_payment","$","document","ready","hasClass","waitPaypalLoaded","showPui","PAYPAL","modePPP","apps","PPP","approvalUrlPPP","languageIsoCodePPP","countryIsoCodePPP","setTimeout","on","e","selectedOption","attr","concat","preventDefault","stopPropagation","doPatchPPP","fancybox","open","content","waitingRedirectionMsg","closeClick","height","helpers","overlay","querySelector","disabled","ajax","type","url","ajaxPatchUrl","dataType","data","idPayment","idPaymentPPP","success","json","doCheckout","window","location","replace","redirect_link"],"sourceRoot":""}