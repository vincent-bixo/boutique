/**
* NOTICE OF LICENSE
*
* This file is part of the 'Wk Warehouses Management' module feature.
* Developped by Khoufi Wissem (2018).
* You are not allowed to use it on several site
* You are not allowed to sell or redistribute this module
* This header must not be removed
*
*  @author    KHOUFI Wissem - K.W
*  @copyright Khoufi Wissem
*  @license   http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
*/
function setBlockHelpFadeOut(){$("#orders-warehouses-help").length>0&&($(".expandible_content").fadeOut("slow"),$("#orders-warehouses-help").prop("checked",!0))}function getCombinationID(e){var t=$("#combination-select").length>0?$("#combination-select").val():$("#ipa_"+e).val();return void 0===t&&(t=0),t}function getProductID(){return $("#product-select").length>0?$("#product-select").val():$("#id_product").val()}function refreshWarehousesQuantitiesInformations(e,t){"undefined"!=typeof showProductWarehousesQuantities&&showProductWarehousesQuantities&&($(".advanced_stock_warehouses_table").replaceWith(""),$.ajax({url:admin_warehouses_orders_url+"&"+Math.random(),dataType:"json",method:"POST",cache:!1,data:{ajax:1,action:"displayOrderProductWarehouses",id_product:e,id_combination:t},beforeSend:function(){$(".advanced_stock_warehouses_table").replaceWith("")},success:function(e){e.content&&0==$(".advanced_stock_warehouses_table").length&&($("#product-search-results .js-quantity-row").length>0?$("#product-search-results .js-quantity-row div:last-child").append(e.content):$("#addProductTableRow").length>0?$("#addProductTableRow > td:first-child").append(e.content):$("#products_found").length>0&&($(e.content).insertAfter($("#qty").parent().find("p")),$(".advanced_stock_warehouses_table").removeClass("col-lg-3").addClass("col-lg-3")))}}))}function ajaxCallPaginate(e,t,o){$.ajax({url:url_global,type:"POST",beforeSend:function(){$(".loading-overlay-"+e).show()},data:{ajax:!0,action:"loadPaginateCombinations",id_product:e,npage:t,pagination_length:o},success:function(t){$(".loading-overlay-"+e).hide(),$(".dataContainer"+e).html(t)}})}function processNow(e,t,o,r){var i,a,s;0==e&&r&&updateProgressionInit(),0!=e||r||updateProgression(0,o,t,!1,null),i=(new Date).getTime(),s="sel"==(a=$(".bulk_for").val())?"&"+$("#"+formID+' input[name="productBox[]"]').serialize():"",$.ajax({type:"POST",url:url_global+"&offset="+e+"&limit="+t+(r?"&validateBefore=1":""),cache:!1,dataType:"json",data:"ajax=1&action="+$(".bulk_action").val()+"&bulk_for="+a+s,success:function(a){var s,n,d,c,l,u,p;if(a.totalCount&&(o=a.totalCount),a.informations&&a.informations.length>0&&updateValidationInfo("<li>"+a.informations.join("</li><li>")+"</li>"),a.warnings&&a.warnings.length>0&&(r?updateValidationError("<li>"+a.warnings.join("</li><li>")+"</li>",!0):updateProgressionError("<li>"+a.warnings.join("</li><li>")+"</li>",!0)),a.errors&&a.errors.length>0)r?updateValidationError("<li>"+a.errors.join("</li><li>")+"</li>",!1):updateProgressionError("<li>"+a.errors.join("</li><li>")+"</li>",!1);else if(1==!a.isFinished){if(s=(new Date).getTime()-i,n=5e3,d=Math.min(4,n/s),c=Math.min(100,Math.max(5,Math.floor(t*d))),l=e+t,r?updateValidation(a.doneCount,o,a.doneCount+c):updateProgression(a.doneCount,o,a.doneCount+c,!1),1==importCancelRequest)return $("#importProgress").modal("hide"),importCancelRequest=!1,void(window.location.href=url_global);processNow(l,c,o,r),a.nextPostSize>=.9*a.postSizeLimit&&(u=100*a.doneCount/o,p=Math.max(7,parseInt(a.postSizeLimit/(1024*u*1024)))+1,$("#import_details_post_limit_value").html(p+" MB"),$("#import_details_post_limit").show())}else r?(updateValidation(o,o,o),$("#import_details_warning").is(":visible")?(importContinueRequest=!0,$("#import_continue_button").show()):($("#import_progress_div").show(),processNow(0,5,o,!1))):(updateProgression(o,o,o,!0),document.getElementById("alarmAudio").play())},error:function(e,t,o){"parsererror"==t&&(t="Technical error: Unexpected response returned by server. Process stopped. Check logs page!"),r?updateValidationError(t,!1):updateProgressionError(t,!1)}})}function updateProgressionInit(){$("#importProgress").modal({backdrop:"static",keyboard:!1,closable:!1}),$("#importProgress").modal("show"),$("#importProgress").on("hidden.bs.modal",function(){window.location.href=url_global}),$("#import_details_progressing").show(),$("#import_details_finished").hide(),$("#import_details_error").hide(),$("#import_details_warning, #import_details_info").hide(),$("#import_details_stop").hide(),$("#import_details_post_limit").hide(),$("#import_details_error ul").html(""),$("#import_details_warning ul, #import_details_info ul").html(""),$("#import_validation_details").html($("#import_validation_details").attr("default-value")),$("#validate_progressbar_done").width("0%"),$("#validate_progressbar_done").parent().addClass("active progress-striped"),$("#validate_progression_done").html("0"),$("#validate_progressbar_done2").width("0%"),$("#validate_progressbar_next").width("0%"),$("#validate_progressbar_next").removeClass("progress-bar-danger"),$("#validate_progressbar_next").addClass("progress-bar-info"),$("#import_progress_div").hide(),$("#import_progression_details").html($("#import_progression_details").attr("default-value")),$("#import_progressbar_done").width("0%"),$("#import_progressbar_done").parent().addClass("active progress-striped"),$("#import_progression_done").html("0"),$("#import_progressbar_next").width("0%"),$("#import_progressbar_next").removeClass("progress-bar-danger"),$("#import_progressbar_next").addClass("progress-bar-success"),$("#import_stop_button").show(),$("#import_close_button").hide(),$("#import_go_button").hide(),$("#import_continue_button").hide()}function updateValidation(e,t,o){var r,i;e>t&&(e=t),o>t&&(o=t),r=100*e/t,i=100*o/t,t>0&&($("#import_validate_div").show(),$("#import_validation_details").html(e+"/"+t),$("#validate_progressbar_done").width(r+"%"),$("#validate_progression_done").html(parseInt(r)),$("#validate_progressbar_next").width(i-r+"%")),e==t&&t==o&&$("#validate_progressbar_done").parent().removeClass("active progress-striped")}function updateProgression(e,t,o,r){var i;e>t&&(e=t),o>t&&(o=t),i=100*e/t,t>0&&($("#import_progress_div").show(),$("#import_progression_details").html(e+"/"+t),$("#import_progressbar_next").width("0%"),$("#import_progressbar_done").width(100-i+"%"),$("#import_progressbar_done2").width(i+"%"),$("#import_progressbar_done2 span").html(parseInt(i)+"%")),r&&($("#import_progressbar_done").parent().removeClass("active progress-striped"),$("#import_details_post_limit").hide(),$("#import_details_progressing").hide(),$("#import_details_finished").show(),$("#importProgress").modal({keyboard:!0,closable:!0}),$("#import_stop_button").hide(),$("#import_close_button").show())}function updateValidationError(e,t){$("#import_details_progressing").hide(),$("#import_details_finished").hide(),t?($("#import_details_warning ul").append(e),$("#import_details_warning").show()):($("#import_details_error ul").append(e),$("#import_details_error").show(),$("#validate_progressbar_next").addClass("progress-bar-danger"),$("#validate_progressbar_next").removeClass("progress-bar-info"),$("#import_stop_button").hide(),$("#import_close_button").show())}function updateValidationInfo(e){$("#import_details_progressing").hide(),$("#import_details_finished").hide(),$("#import_details_info ul").append(e),$("#import_details_info").show()}function updateProgressionError(e,t){$("#import_details_progressing").hide(),$("#import_details_finished").hide(),t?($("#import_details_warning ul").append(e),$("#import_details_warning").show()):($("#import_details_error ul").append(e),$("#import_details_error").show(),$("#import_progressbar_next").addClass("progress-bar-danger"),$("#import_progressbar_next").removeClass("progress-bar-success"),$("#import_stop_button").hide(),$("#import_close_button").show())}function move(e,t){var o=e.find(".warehouseList option:selected");return o.length>1?(showErrorMessage(warehouse_required),!1):(t?o.prev().insertAfter(o):o.next().insertBefore(o),!1)}function checkAllBox(e){var t,o=!0;t="product"==e?$("#form-product").length>0?"form-product":"product":$("#form-order").length>0?"form-order":"order",$("#"+t+" .productOutBox").each(function(){this.checked||(o=!1)}),$("#"+t+" .productOutBox").attr("checked",!o)}function initFormEditWarehousesQties(e,t,o){$(e).addClass("loading"),$.ajax({url:url_global,type:"POST",dataType:"json",data:{ajax:!0,action:"loadFormEditWarehousesQties",id_product:t,id_product_attribute:o,id_warehouses_filter:$("#productFilter_warehouses").val()},success:function(t){$(e).removeClass("loading"),t.hasError||($(".stage_popup_form, .form_popup").fadeIn(500),$(".form_popup .content_form").html(t.content),$(".form_popup").setCenterPositionAbsoluteScreen())}})}function initAutoCompleteSearch(){if($(".product_order_autocomplete_input").length>0){var e=$(".product_order_autocomplete_input");e.autocomplete(admin_warehouses_orders_url,{minChars:1,max:15,selectFirst:!1,scroll:!1,dataType:"json",cacheLength:0,formatItem:function(e,t,o,r,i){return r},parse:function(e){var t,o;for($(".combinations_filter").hide(),$("#orderFilter_combination_q").html(""),t=[],o=0;o<e.length;o++)t[t.length]={data:e[o],value:"- "+e[o].pname+"(ID = "+e[o].id_product+")"};return t},extraParams:{action:"autoCompleteProductFilter"}}).result(function(t,o,r){var i,a;if(null==o)return!1;e.val(o.id_product),i=o.combinations,$(".combinations_filter").length>0&&(a="",$(".combinations_filter").show().fadeIn("slow"),$.each(i,function(){a+='<option value="'+this.id_product_attribute+'">'+this.attributes+"</option>"}),a?$("#orderFilter_combination_q").html(a):($(".combinations_filter").hide(),$("#orderFilter_combination_q").html("")))})}}function assignWarehouseAction(){var e=$("#form-order").length>0?"form-order":"order",t=!1;return $("#"+e+" .productOutBox").each(function(){if(this.checked)return t=!0,!1}),t?(form_action=admin_warehouses_orders_url+"&id_supplier=",$("#"+e).attr("action",form_action),$.ajax({url:url_global,type:"POST",async:!0,dataType:"json",data:{ajax:!0,action:"loadWarehousesForm"},success:function(e){$(".form_popup").html(e.content),$(".stage_popup_form, .form_popup").stop(!0,!0).fadeIn(500),$(".form_popup").css("width","650px").setCenterPositionAbsoluteScreen()}}),!1):(showErrorMessage(product_selection_required),!1)}function fadeHelpIcon(){$(".process-icon-help").fadeOut(1e3,function(){$(this).fadeIn(2e3,fadeHelpIcon())})}function toggleWindow(e){$("#help-header").hasClass("height-transition-hidden")||"bulk"!=e||slideUpPopup("help"),$("#bulk-header").hasClass("height-transition-hidden")||"help"!=e||slideUpPopup("bulk"),$("#"+e+"-header").hasClass("height-transition-hidden")?($("body,html").animate({scrollTop:$("body").offset().top},800),$("#"+e+"-header").slideDownTransition(),$("#"+e+"-header").css({"margin-bottom":"17px"})):slideUpPopup(e)}function slideUpPopup(e){$("#"+e+"-header").slideUpTransition(),$("#"+e+"-header").css({"margin-bottom":"auto"})}var importCancelRequest,importContinueRequest,formID,targetOrderProductElement,url_global=window.location.href;-1!=url_global.indexOf("#")&&(url_global=url_global.split("#")[0]),importCancelRequest=!1,importContinueRequest=!1,formID="form-product",targetOrderProductElement=!1,$(document).ready(function(){var e,t,o,r,a=$("#form-product").length>0?"form-product":"product",s="qpsstats-active-tab",n=window.sessionStorage,d=0;try{d=n.getItem(s)}catch(e){}$("#tabs-config").length>0&&($("#tabs-config").tabs({active:d,activate:function(e,t){var o,r=t.newTab.parent().children().index(t.newTab);try{n.setItem(s,r),o=$("body").offset().top,$("body,html").animate({scrollTop:o},800)}catch(e){}}}),$("#tabs-config").tabs().addClass("ui-tabs-vertical ui-helper-clearfix"),$("#tabs-config li").removeClass("ui-corner-top").addClass("ui-corner-left"),e=0,$(".page-head").length>0&&(e=$(".page-head").outerHeight()+$(".page-head").position().top),"msie"==$.browser&&$.browser.version<7||(t="#float-tabs",o=$(t).offset().top-parseFloat($(t).css("margin-top").replace(/auto/,0)),$(window).scroll(function(r){o<=$(this).scrollTop()?($(t).addClass("fixed"),$(t).css("top",e+"px")):$(t).removeClass("fixed")}))),fadeHelpIcon(),initAutoCompleteSearch(),setBlockHelpFadeOut(),$(document).on("click","#filter-providers, #orders-warehouses-help",function(){$(this).is(":checked")?$(".expandible_content").fadeOut("slow"):$(".expandible_content").fadeIn("slow")}),$(document).on("click","div#addons-rating-container p.dismiss a",function(){return $("div#addons-rating-container").hide(500),$.ajax({type:"GET",url:window.location+"&dismissRating=1"}),!1}),$(".shipment-mode").length>0&&$(".preview_large").fancybox({hideOnContentClick:!1,transitionIn:"elastic",transitionOut:"elastic"}),$(document).on("click",".bulk_action",function(e){"alignReservedQties"==$(this).val()?($(".bulk_for").val("sel"),$(".bulk_for option[value='all']").attr("disabled",!0).css("color","#bbb")):$(".bulk_for option[value='all']").attr("disabled",!1).removeAttr("style")}),$(document).on("click",".check_all_warehouses",function(e){var t=$(this).closest("div").find("table tbody .chk_locations");$(this).hasClass("selected")?(t.each(function(){$(this).removeAttr("checked")}),$(this).find("i").removeClass("icon-check-sign").addClass("icon-check-empty"),$(this).removeClass("selected")):(t.each(function(){$(this).prop("checked",!0)}),$(this).find("i").removeClass("icon-check-empty").addClass("icon-check-sign"),$(this).addClass("selected"))}),$(document).on("click",".check_all",function(e){var t=$(this).is(":checked"),o=$(this).parent().parent().parent().parent();o.find(".productOutBox").prop("checked",t)}),$(document).on("click",".stage_popup_form, .close_form_popup",function(e){e.preventDefault(),$(".stage_popup_form, .form_popup").fadeOut(500)}),$(document).on("click",".edit_warehouses",function(e){var t,o,r;e.preventDefault(),t=$(this).data("id"),o=$(this).data("id-pa")?$(this).data("id-pa"):0,r=this,$(r).addClass("loading"),$.ajax({type:"POST",url:url_global,cache:!1,dataType:"json",data:{ajax:!0,action:"initFormLocations",id_product:t,id_product_attribute:o,id_warehouses_filter:$("#productFilter_warehouses").val()},success:function(e){$(r).removeClass("loading"),$(".stage_popup_form, .form_popup").fadeIn(500),e.error?$(".form_popup .content_form").html(e.error):$(".form_popup .content_form").html(e.html),$(".form_popup").setCenterPositionAbsoluteScreen()}})}),$(document).on("click","#save-warehouses-locations-foreach",function(e){id_product=$("#product_id").val(),id_product_attribute=$("#product_attribute_id").val(),$.ajax({url:url_global,type:"POST",async:!1,cache:!1,dataType:"json",data:"id_product="+id_product+"&ajax=1&action=processWarehousesAndLocations&id_product_attribute="+id_product_attribute+"&"+$("input[class=chk_locations]").serialize()+"&"+$("input[class=input_locations]").serialize(),success:function(e){e.error?showErrorMessage(data.error):(showSuccessMessage(update_success_msg),$(".stage_popup_form, .form_popup").fadeOut(500))}})}),$(document).on("click",".edit_warehouses_product",function(e){var t=$(this).data("id"),o=this;$(o).addClass("loading"),$.ajax({type:"POST",url:url_global,async:!1,cache:!1,dataType:"json",data:{ajax:!0,action:"initFormWarehouses",id_product:t,id_warehouses_filter:$("#productFilter_warehouses").val()},success:function(e){$(o).removeClass("loading"),$(".stage_popup_form, .form_popup").fadeIn(500),e.error?$(".form_popup .content_form").html(e.error):$(".form_popup .content_form").html(e.html),$(".form_popup").setCenterPositionAbsoluteScreen()}})}),$(document).on("click","#save-warehouses-locations-forall",function(e){id_product=$("#product_id").val(),$.ajax({url:url_global,type:"POST",async:!1,cache:!1,dataType:"json",data:"id_product="+id_product+"&ajax=1&action=processAllWarehousesAndLocations&"+$("input[class=chk_locations]").serialize()+"&"+$("input[class=input_locations]").serialize(),success:function(e){e.error?showErrorMessage(data.error):(showSuccessMessage(update_success_msg),$(".stage_popup_form, .form_popup").fadeOut(500))}})}),$(document).on("click",".set_warehouses_stock",function(e){e.preventDefault(),initFormEditWarehousesQties(this,$(this).data("id"),$(this).data("id-pa")?$(this).data("id-pa"):0)}),$(document).on("blur",".edit_realstock",function(e){var t,o,r;e.preventDefault(),t=$(this).attr("data-id"),o=$(this).attr("data-id-pa"),r=$(this).val(),$(this).parent().parent(),$.ajax({url:url_global,type:"POST",async:!1,cache:!1,dataType:"json",data:{ajax:!0,action:"updateRealQty",qty:r,id_product:t,id_product_attribute:o},success:function(e){e.result?"same"!=e.result&&("function"==typeof showSuccessMessage&&showSuccessMessage(update_success_msg),$("#real_quantity_"+t+"_"+o).addClass("update_done"),$(".physical_qty_"+t+"_"+o).html(e.physical_quantity).addClass("value_done"),$(".reserved_qty_"+t+"_"+o).html(e.reserved_quantity).addClass("value_done")):showErrorMessage(e.error)}})}),$(document).on("click",".applyQuantityAdvancedStock",function(e){var t,o=this;e.preventDefault(),t=$(this).closest("tr").find(":input").serialize(),$.ajax({url:url_global,type:"POST",dataType:"json",data:t+"&ajax=1&action=saveFormEditWarehousesQties",success:function(e){var t,r;e.hasError?e.msgError&&showErrorMessage(e.msgError):(t=$(o).data("id-product"),r=$(o).data("id-product-attribute"),showSuccessMessage(void 0!==e.msgSuccess?e.msgSuccess:update_success_msg),void 0!==e.quantity&&($("#real_quantity_"+t+"_"+r).addClass("value_done").val(e.quantity),$(".physical_qty_"+t+"_"+r).html(e.physical_quantity).addClass("value_done"),$(".warehouses_qty_"+t+"_"+r).html(e.warehouses_quantity).addClass("value_done")),initFormEditWarehousesQties(o,t,r))}})}),$(document).on("click",".alignWarehouseToPhysicalQty",function(e){var t,o,r;e.preventDefault(),t=this,o=$(t).data("id-product"),r=$(t).data("id-product-attribute"),$.ajax({url:url_global,type:"POST",dataType:"json",data:{ajax:1,action:"alignWarehousesQties",id_product:o,id_product_attribute:r},success:function(e){e.hasError?e.msgError&&showErrorMessage(e.msgError):(showSuccessMessage(e.msgSuccess),initFormEditWarehousesQties(t,o,r))}})}),$(document).on("change",".warehouse-select",function(){var e,t;if(currentElement=$(this),e=parseInt(currentElement.attr("id").replace("warehouse_","")),""==(t=currentElement.val())&&"undefined"!=typeof help_class_name&&"AdminWkwarehousesOrders"==help_class_name)return showErrorMessage(txt_warehouse_required),!1;$.ajax({url:admin_warehouses_orders_url,dataType:"json",method:"POST",data:{ajax:1,action:"updateOrderWarehouse",id_warehouse:t,id_order_detail:e},success:function(e){e.hasError?(showErrorMessage(e.msgError),currentElement.find("option").prop("selected",function(){return this.defaultSelected})):showSuccessMessage(e.msgOk)}})}),$(".formConfigWarehouses").on("submit",function(e){$("#priority_increase .warehouseList option, #priority_decrease .warehouseList option").prop("selected",!0)}),$("#priority_increase .menuOrderUp, #priority_decrease .menuOrderUp").click(function(e){e.preventDefault(),move($(this).parent().parent(),!0)}),$("#priority_increase .menuOrderDown, #priority_decrease .menuOrderDown").click(function(e){e.preventDefault(),move($(this).parent().parent(),!1)}),$(".swap-container").length>0&&$(".swap-container").each(function(){void 0!==typeof $(".addSwap",this)&&void 0!==typeof $(".removeSwap",this)&&void 0!==typeof $(".selectedSwap",this)&&void 0!==typeof $(".availableSwap",this)&&(container=this,bindSwapButton("add","available","selected",container),bindSwapButton("remove","selected","available",container),$("button:submit").click(function(){bindSwapSave(container)}))}),$(document).on("click","#WKWAREHOUSE_LOCATION_ORDER_PAGE_on",function(){$("input[name=WKWAREHOUSE_CHANGE_ORDER_WAREHOUSE]").attr("disabled",!1)}),$(document).on("click","#WKWAREHOUSE_LOCATION_ORDER_PAGE_off",function(){$("input[id=WKWAREHOUSE_CHANGE_ORDER_WAREHOUSE_off]").attr("checked",!0),$("input[name=WKWAREHOUSE_CHANGE_ORDER_WAREHOUSE]").attr("disabled",!0)}),$(document).on("click","#WKWAREHOUSE_ALLOWSET_WAREHOUSE_on",function(){$("input[name=WKWAREHOUSE_DISPLAY_SELECTED_WAREHOUSE]").attr("disabled",!0),$("input[id=WKWAREHOUSE_DISPLAY_SELECTED_WAREHOUSE_off]").attr("checked",!0)}),$(document).on("click","#WKWAREHOUSE_ALLOWSET_WAREHOUSE_off",function(){$("input[name=WKWAREHOUSE_DISPLAY_SELECTED_WAREHOUSE]").attr("disabled",!1),$("input[id=WKWAREHOUSE_DISPLAY_SELECTED_WAREHOUSE_on]").attr("checked",!1)}),$(document).on("click","#WKWAREHOUSE_DISPLAY_SELECTED_WAREHOUSE_on",function(){$("input[name=WKWAREHOUSE_ALLOWSET_WAREHOUSE]").attr("disabled",!0),$("input[id=WKWAREHOUSE_ALLOWSET_WAREHOUSE_off]").attr("checked",!0)}),$(document).on("click","#WKWAREHOUSE_DISPLAY_SELECTED_WAREHOUSE_off",function(){$("input[name=WKWAREHOUSE_ALLOWSET_WAREHOUSE]").attr("disabled",!1),$("input[id=WKWAREHOUSE_ALLOWSET_WAREHOUSE_on]").attr("checked",!1)}),$(document).on("click","#WKWAREHOUSE_DISPLAY_WAREHOUSE_NAME_off",function(){$("input[id=WKWAREHOUSE_DISPLAY_SELECTED_LOCATION_on]").attr("checked",!0)}),$(document).on("click","#WKWAREHOUSE_DISPLAY_SELECTED_LOCATION_off",function(){$("input[id=WKWAREHOUSE_DISPLAY_WAREHOUSE_NAME_on]").attr("checked",!0)}),$(document).on("click","#WKWAREHOUSE_WAREHOUSES_INCART_off",function(){$("input[id=WKWAREHOUSE_LOCATIONS_INCART_on]").attr("checked",!0)}),$(document).on("click","#WKWAREHOUSE_LOCATIONS_INCART_off",function(){$("input[id=WKWAREHOUSE_WAREHOUSES_INCART_on]").attr("checked",!0)}),$(document).on("click","#WKWAREHOUSE_ALLOW_MULTIWH_CART_off",function(){$("input[name=WKWAREHOUSE_ALLOW_MULTICARRIER_CART]").attr("disabled",!0),$("input[id=WKWAREHOUSE_ALLOW_MULTICARRIER_CART_off]").attr("checked",!0)}),$(document).on("click","#WKWAREHOUSE_ALLOW_MULTIWH_CART_on",function(){$("input[name=WKWAREHOUSE_ALLOW_MULTICARRIER_CART]").attr("disabled",!1)}),$("#import_stop_button").unbind("click").click(function(){importContinueRequest?($("#importProgress").modal("hide"),importContinueRequest=!1,window.location.href=url_global):(importCancelRequest=!0,$("#import_details_progressing").hide(),$("#import_details_finished").hide(),$("#import_details_stop").show(),$("#import_stop_button").hide(),$("#update_close_button").hide())}),$("#import_continue_button").unbind("click").click(function(){$("#import_continue_button").hide(),importContinueRequest=!1,$("#import_progress_div").show(),$("#import_details_warning ul, #import_details_info ul").html(""),$("#import_details_warning, #import_details_info").hide(),processNow(0,5,-1,!1)}),$("#update_close_button, #importProgress .close").unbind("click").click(function(){window.location.href=url_global}),$(document).on("click","#submit-bulk-btn",function(e){e.preventDefault();var t=!1;if("sel"==$(".bulk_for").val()&&($("#"+a+" .productOutBox").each(function(){if(this.checked)return t=!0,!1}),!t))return showErrorMessage(msg_required),!1;processNow(0,5,-1,!0)}),"undefined"!=typeof orderLocations&&($("#orderProductsTable").length>0?$("#orderProductsTable thead tr").find("th:nth-child(3)").after('<th class="text-left"><p>'+txt_warehouse+"</p></th>"):$("#orderProducts thead tr").find("th:nth-child(5)").html('<span class="title_box"><strong>'+txt_warehouse+"</strong></span>"),r=$("#orderProductsTable").length>0?"orderProductsTable":"orderProducts",$("#"+r+" tbody "+("orderProducts"==r?"tr.product-line-row":"tr")).each(function(){var e,t,o="orderProducts"==r?$(this).find("td .edit_product_id_order_detail").val():parseInt($(this).attr("id").replace("orderProduct_",""));if(void 0!==o)if(void 0!==(e=orderLocations[o])){for(t='<ul style="padding-left:10px">',i=0;i<e.length;i++){if(canChangeWarehouse){if(e[i].warehouseList){for(k in t+='<li><select class="warehouse-select" id="'+o+'">',t+='<option value="">-- '+txt_no_warehouse+" --</option>",e[i].warehouseList)t+='<option value="'+e[i].warehouseList[k].id_warehouse+'" ',t+=e[i].warehouseList[k].is_default?"selected":"",t+=">"+e[i].warehouseList[k].name+"</option>";t+="</select></li>"}}else t+="<li>"+e[i].name+"</li>";""!=e[i].location&&"undefined"!=e[i].location&&(t+='<li style="list-style-type:none">'+txt_location+": "+e[i].location+"</li>")}t+="</ul>","orderProducts"==r?$(this).find("td:nth-child(5)").html(t):$(this).find("td:nth-child(3)").after('<td class="cellProductWarehouse text-left">'+t+"</td>")}else"orderProducts"==r?$(this).find("td:nth-child(5)").html(""):$(this).find("td:nth-child(3)").after("<td></td>")})),$(document).on("keyup","#cron_mhdmd",function(){$element=$(this);var e=$element.val();e?$.ajax({type:"POST",url:url_global,dataType:"json",data:{ajax:!0,action:"checkExpression",expression:e},success:function(t){t.human_description&&($(".frequency_description .description_text").html(t.human_description),$element.removeClass("syntax_error")),t.expression&&($(".frequency_description .minutes .value").html(t.expression.min),$(".frequency_description .hours .value").html(t.expression.hour),$(".frequency_description .day_of_month .value").html(t.expression.day_of_month),$(".frequency_description .month .value").html(t.expression.month),$(".frequency_description .day_of_week .value").html(t.expression.day_of_week),$(".planification-crontime").html(e)),t.error&&($element.addClass("syntax_error"),showErrorMessage(trans_syntax_error))}}):($element.addClass("syntax_error"),showErrorMessage(trans_syntax_error))}),$(document).on("click",".adminwkwarehousesmanageqty ul.pagination li:not(.active) a",function(e){e.preventDefault(),ajaxCallPaginate($(this).closest(".list_combinations").data("id-product"),$(this).data("page"),$(".pagination_length").val())}),$(document).on("change",".adminwkwarehousesmanageqty .pagination_length",function(){var e=$(this).val(),t=$(this).closest(".list_combinations").data("id-product");e&&ajaxCallPaginate(t,0,e)}),$(document).on("click","#submit-assign-warehouse-btn",function(e){var t,o;e.preventDefault(),t=$("#form-order").length>0?"form-order":"order",-1!=(o=$("#"+t).attr("action")).indexOf("#")&&(o=o.split("#")[0]),o+="&submitBulkWarehouseAssignement&id_warehouse="+$(".id_warehouse").val(),$("#"+t).attr("action",o),document.getElementById(t).submit()}),$(document).on("keypress","#product-search, #product",function(e){targetOrderProductElement=!0}),$("#product-search, #product").bind("paste",function(){targetOrderProductElement=!0}),$(document).ajaxComplete(function(e,t,o){setting_url=o.url,!targetOrderProductElement||-1==setting_url.indexOf("/index.php/sell/orders/products/search")&&-1==setting_url.indexOf("index.php?controller=AdminOrders")||($(".advanced_stock_warehouses_table").replaceWith(""),setTimeout(function(){var e=getProductID();refreshWarehousesQuantitiesInformations(e,getCombinationID(e))},500))}),$(document).on("change","#product-select, #id_product",function(e){refreshWarehousesQuantitiesInformations($(this).val(),getCombinationID($(this).val()))}),$(document).on("change","#combination-select, .id_product_attribute",function(e){refreshWarehousesQuantitiesInformations(getProductID(),$(this).val())}),$(document).on("click","#addProductTableRow .dropdown .dropdown-item",function(e){refreshWarehousesQuantitiesInformations($(this).data("id"),$("#addProductCombinationId").val())}),$(document).on("change","#addProductCombinationId",function(e){$(".advanced_stock_warehouses_table").replaceWith(""),refreshWarehousesQuantitiesInformations($(this).closest(".add-product").find("#add_product_row_product_id").val(),$(this).val())})}),void 0===$.fn.setCenterPositionAbsoluteScreen&&($.fn.setCenterPositionAbsoluteScreen=function(){var e=20,t=$(document).scrollTop(),o=$(this).width(),r=$(window).width();$(this).css({top:$(this).height()>$(window).height()?t+e:t+($(window).height()-$(this).height())/2,left:(r-o)/2})}),function(e){e.fn.slideUpTransition=function(){return this.each(function(){var t=e(this);t.css("max-height","0"),t.addClass("height-transition-hidden")})},e.fn.slideDownTransition=function(){return this.each(function(){var t,o=e(this);o.removeClass("height-transition-hidden"),o.css("max-height","none"),t=o.outerHeight(),o.css("max-height","0"),setTimeout(function(){o.css({"max-height":t})},1)})}}(jQuery);
